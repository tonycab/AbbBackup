MODULE MOD_VISION3D_LIB2(SYSMODULE,NOSTEPIN)

    FUNC num ElementToNum(string Element)

        VAR bool b;
        VAR num value;
        b:=StrToVal(Element,value);
        RETURN value;

    ENDFUNC

    !***************************************************************************************************
    PROC Serialize_Data(INOUT string Elements{*},INOUT byte Data{*})

        VAR num i;
        VAR num j;
        VAR num index:=1;
        VAR string Delimiter:=";";

        FOR j FROM 1 TO Dim(Elements,1) DO

            FOR i FROM 1 TO StrLen(Elements{j}) DO
                Data{index}:=StrToByte(StrPart(Elements{j},i,1)\Char);
                index:=index+1;
            ENDFOR

            Data{index}:=StrToByte(Delimiter\Char);
            index:=index+1;

        ENDFOR

    ERROR

    ENDPROC

    !***************************************************************************************************
    PROC DeSerialize_Data(INOUT byte Data{*},INOUT string Elements{*})

        VAR num i;
        VAR num index:=1;
        VAR string Element;
        VAR string Delimiter:=";";

        FOR i FROM 1 TO Dim(Data,1) DO

            IF index>Dim(Elements,1) RETURN ;

            IF Data{i}<>StrToByte(Delimiter\Char) THEN

                IF Data{i}<>0 THEN
                    Elements{index}:=Elements{index}+ByteToStr(Data{i}\Char);

                ENDIF

            ELSE
                index:=index+1;

            ENDIF

        ENDFOR

    ENDPROC

    !***************************************************************************************************
    PROC Clear_Data(INOUT byte Data{*})

        VAR num i;

        FOR i FROM 1 TO Dim(Data,1) DO
            Data{i}:=0;
        ENDFOR

    ENDPROC

    !***************************************************************************************************
    !Interface utilisateur pour proposer l'enregistrement du repère comme référence
    FUNC bool UIYesNo(string Messages{*})

        VAR btnres Reponse;
        CONST string Boutons{2}:=["Yes","No"];

        Reponse:=UIMessageBox(\Header:="UIMessageBox Header"\MsgArray:=Messages\wrap\BtnArray:=Boutons\Icon:=iconInfo);

        IF Reponse=1 THEN
            RETURN TRUE;

        ELSEIF Reponse=2 THEN
            RETURN FALSE;

        ENDIF

    ENDFUNC

ENDMODULE