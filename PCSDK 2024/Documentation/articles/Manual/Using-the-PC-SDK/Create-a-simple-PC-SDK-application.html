<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Create a simple PC SDK application </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Create a simple PC SDK application ">
    <meta name="generator" content="docfx 2.59.2.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc">
    <meta property="docfx:tocrel" content="../toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../images/ABBLogo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../../articles/Introduction/GettingStarted.html" title="Introduction">Introduction</a>
                      </li>
                      <li>
                          <a href="../../../articles/Manual/Manual-Topic.html" title="Manual">Manual</a>
                      </li>
                      <li>
                          <a href="../../../articles/Samples/Samples-Topic.html" title="Samples">Samples</a>
                      </li>
                      <li>
                          <a href="../../../api/index.html" title="API Reference">API Reference</a>
                      </li>
                      <li>
                          <a href="../../../articles/releases/pc-sdk-2024-4.html" title="Releases">Releases</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../Introduction/Introduction-Topic.html" title="Introduction" class="">Introduction</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../Introduction/About-creating-controller-applications.html" title="About creating controller applications" class="">About creating controller applications</a>
                          </li>
                          <li class="">
                            <a href="../Introduction/Documentation-and-help.html" title="Documentation and help" class="">Documentation and help</a>
                          </li>
                          <li class="">
                            <a href="../Introduction/Terminology.html" title="Terminology" class="">Terminology</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../Installation-and-development-environment/Installation-and-development-environment-Topic.html" title="Installation and development environment" class="">Installation and development environment</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../Installation-and-development-environment/Installation-overview.html" title="Installation overview" class="">Installation overview</a>
                          </li>
                          <li class="">
                            <a href="../Installation-and-development-environment/How-to-set-up-your-PC-to-communicate-with-robot.html" title="How to set up your PC to communicate with robot" class="">How to set up your PC to communicate with robot</a>
                          </li>
                          <li class="">
                            <a href="../Installation-and-development-environment/Development-overview.html" title="Development environment" class="">Development environment</a>
                          </li>
                          <li class="">
                            <a href="../Installation-and-development-environment/Two-development-models---virtual-and-real.html" title="Two development models - virtual and real" class="">Two development models - virtual and real</a>
                          </li>
                          <li class="">
                            <a href="../Installation-and-development-environment/Installation-Directory.html" title="Installation Directory" class="">Installation Directory</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../Run-time-environment/Run-time-environment-Topic.html" title="Run-time environment" class="">Run-time environment</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../Run-time-environment/Overview.html" title="Overview" class="">Overview</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../Run-time-environment/Running-PC-SDK-Applications/Running-PC-SDK-Applications-Topic.html" title="Running PC SDK Applications" class="">Running PC SDK Applications</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../Run-time-environment/Running-PC-SDK-Applications/Running-PC-SDK-Applications-Overview.html" title="Overview" class="">Overview</a>
                                </li>
                                <li class="">
                                  <a href="../Run-time-environment/Running-PC-SDK-Applications/Mastership.html" title="Mastership" class="">Mastership</a>
                                </li>
                                <li class="">
                                  <a href="../Run-time-environment/Running-PC-SDK-Applications/PC-application-configuration.html" title="PC application configuration" class="">PC application configuration</a>
                                </li>
                                <li class="">
                                  <a href="../Run-time-environment/Running-PC-SDK-Applications/Communication-between-PC-and-Controller.html" title="Communication between PC and Controller" class="">Communication between PC and Controller</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <a href="../Run-time-environment/Release-upgrades-and-compatibility.html" title="Release upgrades and compatibility" class="">Release upgrades and compatibility</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../Developing-Controller-applications/Developing-Controller-applications-Topic.html" title="Developing Controller applications" class="">Developing Controller applications</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../Developing-Controller-applications/Developing-Controller-applications-introduction.html" title="Introduction" class="">Introduction</a>
                          </li>
                          <li class="">
                            <a href="../Developing-Controller-applications/Analysis-and-design.html" title="Analysis and design" class="">Analysis and design</a>
                          </li>
                          <li class="">
                            <a href="../Developing-Controller-applications/Controller-events-and-threads.html" title="Controller events and threads" class="">Controller events and threads</a>
                          </li>
                          <li class="">
                            <a href="../Developing-Controller-applications/User-Authorization-system.html" title="User Authorization system" class="">User Authorization system</a>
                          </li>
                          <li class="">
                            <a href="../Developing-Controller-applications/Exception-handling.html" title="Exception handling" class="">Exception handling</a>
                          </li>
                          <li class="">
                            <a href="../Developing-Controller-applications/How-to-use-the-online-help.html" title="How to use the online help" class="">How to use the online help</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../Using-the-PC-SDK/Using-the-PC-SDK-Topic.html" title="Using the PC SDK" class="">Using the PC SDK</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../Using-the-PC-SDK/Controller-API.html" title="Controller API" class="">Controller API</a>
                          </li>
                          <li class="active">
                            <a href="../Using-the-PC-SDK/Create-a-simple-PC-SDK-application.html" title="Create a simple PC SDK application" class="active">Create a simple PC SDK application</a>
                          </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/Discovery-domain.html" title="Discovery domain" class="">Discovery domain</a>
                          </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/Accessing-the-controller.html" title="Accessing the controller" class="">Accessing the controller</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../Using-the-PC-SDK/Using-the-PC-SDK-Topic.html" title="Rapid domain" class="">Rapid domain</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../Using-the-PC-SDK/Rapid-domain/Working-with-RAPID-data.html" title="Working with RAPID data" class="">Working with RAPID data</a>
                                </li>
                                <li class="">
                                  <a href="../Using-the-PC-SDK/Rapid-domain/Handling-arrays.html" title="Handling arrays" class="">Handling arrays</a>
                                </li>
                                <li class="">
                                  <a href="../Using-the-PC-SDK/Rapid-domain/ReadItem-and-WriteItem-methods.html" title="ReadItem and WriteItem methods" class="">ReadItem and WriteItem methods</a>
                                </li>
                                <li class="">
                                  <a href="../Using-the-PC-SDK/Rapid-domain/UserDefined-data.html" title="UserDefined data" class="">UserDefined data</a>
                                </li>
                                <li class="">
                                  <a href="../Using-the-PC-SDK/Rapid-domain/RAPID-symbol-search.html" title="RAPID symbol search" class="">RAPID symbol search</a>
                                </li>
                                <li class="">
                                  <a href="../Using-the-PC-SDK/Rapid-domain/Working-with-RAPID-modules-and-programs.html" title="Working with RAPID modules and programs" class="">Working with RAPID modules and programs</a>
                                </li>
                                <li class="">
                                  <a href="../Using-the-PC-SDK/Rapid-domain/Enable-operator-response-to-RAPID-UI-instructions-from-a-PC.html" title="Enable operator response to RAPID UI-instructions from a PC" class="">Enable operator response to RAPID UI-instructions from a PC</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/IO-system-domain.html" title="I/O system domain" class="">I/O system domain</a>
                          </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/Configuration-domain.html" title="Configuration domain" class="">Configuration domain</a>
                          </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/Event-log-domain.html" title="Event log domain" class="">Event log domain</a>
                          </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/Motion-domain.html" title="Motion domain" class="">Motion domain</a>
                          </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/File-system-domain.html" title="File system domain" class="">File system domain</a>
                          </li>
                          <li class="">
                            <a href="../Using-the-PC-SDK/Messaging-domain.html" title="Messaging domain" class="">Messaging domain</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../Debugging-and-troubleshooting/Debugging-and-troubleshooting-Topic.html" title="Debugging and troubleshooting" class="">Debugging and troubleshooting</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../Debugging-and-troubleshooting/Debugging.html" title="Debugging" class="">Debugging</a>
                          </li>
                          <li class="">
                            <a href="../Debugging-and-troubleshooting/Troubleshooting.html" title="Troubleshooting" class="">Troubleshooting</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../Deployment-of-a-PC-SDK-application/Deployment-of-a-PC-SDK-application-Topic.html" title="Deployment of a PC SDK application" class="">Deployment of a PC SDK application</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../Deployment-of-a-PC-SDK-application/Deployment-of-a-PC-SDK-application-overview.html" title="Deployment" class="">Deployment</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="Create-a-simple-PC-SDK-application">
<h1 id="create-a-simple-pc-sdk-application">Create a simple PC SDK application</h1>

<h2 id="overview">Overview</h2>
<p>To get started with programming, create a simple application that displays all the virtual and real controllers on the network.
It should then be possible to log on to a controller and start RAPID execution.</p>
<div class="CAUTION">
<h5>Caution</h5>
<p>Remote access to controllers must be handled carefully. Make sure you do not unintentionally disturb a system in production.</p>
</div>
<h2 id="setting-up-the-project">Setting up the project</h2>
<p>Use this procedure to set up a PC SDK project:</p>
<ol>
<li><p>On the <strong>File</strong> menu in Visual Studio, select <strong>New</strong> and click <strong>Project</strong>. Select a <strong>Windows Application</strong> project.</p>
</li>
<li><p>Add a reference to the PC SDK assembly, <em>ABB.Robotics.Controllers.PC.dll</em>, to the project. The default location of this assembly
is <a class="xref" href="../Installation-and-development-environment/Installation-Directory.html">installation directory</a>.</p>
</li>
<li><p>Open <em>Form1.cs</em> and add the needed namespace statements at the top of the source code page:</p>
<pre><code class="lang-csharp">using ABB.Robotics.Controllers.PC;
using ABB.Robotics.Controllers.Discovery;
using ABB.Robotics.Controllers.RapidDomain;
</code></pre>
</li>
<li><p>In the <strong>Solution Explorer</strong> right-click <em>Form1.cs</em> and select <strong>View Designer</strong>. Create the Graphical User Interface according to
the instruction in the next section.</p>
</li>
</ol>
<h2 id="create-the-user-interface">Create the user interface</h2>
<p>The following screenshot shows the running PC SDK application that we will create. As you see both virtual and real controllers on the network are included in a network scan.</p>
<p><img src="../../../images/createui.jpg" alt=""></p>
<p>Use this procedure to create the user interface of the application:</p>
<ol>
<li><p>Change the <strong>Text</strong> property of the form to <em>Network scanning window</em>.</p>
</li>
<li><p>Change its <strong>Size</strong> to 850; 480.</p>
</li>
<li><p>Add a <code>ListView</code> control to the form. Set the following properties to get a similar look as in the figure above:</p>
<p><strong>FullRowSelect</strong> - True</p>
<p><strong>GridLines</strong> - True</p>
<p><strong>View</strong> - Details</p>
</li>
<li><p>Add the columns for <em>IPAddress</em>, <em>ID</em>, <em>Availability</em>, <em>Virtual</em>, <em>System name</em>, <em>RobotWare Version</em> and <em>Controller name</em> and
adjust the width of the columns.</p>
</li>
<li><p>Add a <code>Panel</code> with a <code>Button</code> under the listview. Set the <code>Text</code> of the button.</p>
</li>
</ol>
<h2 id="implement-network-scanning">Implement network scanning</h2>
<p>To find all controllers on the network we start by declaring these member variables in the class:</p>
<pre><code class="lang-csharp">private NetworkScanner scanner = null;
private Controller controller = null;
private Task[] tasks = null;
private NetworkWatcher networkwatcher = null;
</code></pre>
<p>As the application is supposed to scan the network as soon as it is started, we can put the code for it in the event handler,
like this:</p>
<pre><code class="lang-csharp">this.scanner = new NetworkScanner();
this.scanner.Scan();
ControllerInfoCollection controllers = scanner.Controllers;
ListViewItem item = null;
foreach (ControllerInfo controllerInfo in controllers)
{
    item = new ListViewItem(controllerInfo.IPAddress.ToString());
    item.SubItems.Add(controllerInfo.Id);
    item.SubItems.Add(controllerInfo.Availability.ToString());
    item.SubItems.Add(controllerInfo.IsVirtual.ToString());
    item.SubItems.Add(controllerInfo.SystemName);
    item.SubItems.Add(controllerInfo.Version.ToString());
    item.SubItems.Add(controllerInfo.ControllerName);
    this.listView1.Items.Add(item);
    item.Tag = controllerInfo;
}
</code></pre>
<h2 id="add-a-network-watcher">Add a network watcher</h2>
<p>By implementing a <code>NetworkWatcher</code> the application can supervise the network and detect when controllers are lost or added.
This example shows how to program network supervision, and how to add a detected controller to the listview.</p>
<p>After having added a <code>NetworkWatcher</code> object to the <code>FormLoad</code> event handler, we add a subscription to its <code>Found</code> event.</p>
<pre><code class="lang-csharp">this.networkwatcher = new NetworkWatcher(scanner.Controllers);
this.networkwatcher.Found += new EventHandler&lt;NetworkWatcherEventArgs&gt;(HandleFoundEvent);
this.networkwatcher.Lost += new EventHandler&lt;NetworkWatcherEventArgs&gt;(HandleLostEvent);
this.networkwatcher.EnableRaisingEvents = true;
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>In C# the event handler skeleton is auto generated using the Tab key twice after “+=” in the above statements. If you prefer,
you can use a simplified syntax when using generic event handlers:</p>
<p><code>networkwatcher.Found += HandleFoundEvent;</code></p>
</div>
<h2 id="handle-event">Handle event</h2>
<p>As the events will be received on a background thread and should result in an update of the user interface the <code>Invoke</code> method must
be called in the event handler. For more information on how to force execution from background to GUI thread,
see <a class="xref" href="../Developing-Controller-applications/Controller-events-and-threads.html#invoke-method">Invoke method</a>.</p>
<pre><code class="lang-csharp">void HandleFoundEvent(object sender, NetworkWatcherEventArgs e)
{
    this.Invoke(new
    EventHandler&lt;NetworkWatcherEventArgs&gt;(AddControllerToListView),
    new Object[] { this, e });
}
</code></pre>
<p>This event handler updates the user interface:</p>
<pre><code class="lang-csharp">private void AddControllerToListView(object sender,NetworkWatcherEventArgs e)
{
    ControllerInfo controllerInfo = e.Controller;
    ListViewItem item = new ListViewItem(controllerInfo.IPAddress.ToString());
    item.SubItems.Add(controllerInfo.Id);
    item.SubItems.Add(controllerInfo.Availability.ToString());
    item.SubItems.Add(controllerInfo.IsVirtual.ToString());
    item.SubItems.Add(controllerInfo.SystemName);
    item.SubItems.Add(controllerInfo.Version.ToString());
    item.SubItems.Add(controllerInfo.ControllerName);
    this.listView1.Items.Add(item);
    item.Tag = controllerInfo;
}
</code></pre>
<h2 id="establish-connection-to-controller">Establish connection to controller</h2>
<p>When you double-click a controller in the list, a connection to that controller must be established and you must be logged on.
Use the following procedure to implement this functionality.</p>
<ol>
<li>Generate <code>DoubleClick</code> event of the <code>ListView</code>.</li>
<li>In the event handler create a <code>Controller</code> object that represents the selected robot controller.</li>
<li>Log on to the selected controller. For more information, see the code sample of
<a class="xref" href="Create-a-simple-PC-SDK-application.html#implement-event-handler">Implement event handler</a>.</li>
</ol>
<h2 id="implement-event-handler">Implement event handler</h2>
<p>This example shows the code of the <code>ListView.DoubleClick</code> event handler:</p>
<pre><code class="lang-csharp">ListViewItem item = this.listView1.SelectedItems[0];
if (item.Tag!= null)
{
    ControllerInfo controllerInfo = (ControllerInfo)item.Tag;
    if (controllerInfo.Availability == Availability.Available)
    {
        if (this.controller != null)
        {
            this.controller.Logoff();
            this.controller.Dispose();
            this.controller = null;
        }
        this.controller = ControllerFactory.CreateFrom(controllerInfo);
        this.controller.Logon(UserInfo.DefaultUser);
    }
    else
    {
        MessageBox.Show(&quot;Selected controller not available.&quot;);
    }
}
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>The check to see whether the <code>Controller</code> object already exists is important, as you should explicitly log off and dispose of any
existing controller object before creating a new one. The reason is that a logon session allocates resources that should not be
kept longer than necessary.</p>
</div>
<h2 id="start-program-execution">Start program execution</h2>
<p>The <code>Click</code> event handler of the <strong>Start RAPID Program</strong> button should start program execution of the first RAPID task.</p>
<p>Starting RAPID execution in manual mode can only be done from the FlexPendant, so we need to check that the controller is in
automatic mode before trying. We then need to request mastership of <code>Rapid</code> and call the <code>Start</code> method. If mastership is already
held, by ourselves or another client, an <code>InvalidOperationException</code> will be thrown. For further information,
see <a class="xref" href="../Run-time-environment/Running-PC-SDK-Applications/Mastership.html">Mastership</a>.</p>
<p>It is necessary to release mastership whether or not the start operation succeeds. This can be done by calling <code>Release()</code> or
<code>Dispose()</code> in a finally clause, as shown in the VB example, or by applying the <code>using</code> mechanism, as shown in the C# example.</p>
<pre><code class="lang-csharp">private void button1_Click(object sender, EventArgs e)
{
    try
    {
        if (controller.OperatingMode == ControllerOperatingMode.Auto)
        {
            tasks = controller.Rapid.GetTasks();
            using (Mastership m =Mastership.Request(controller.Rapid))
            {
                //Perform operation
                tasks[0].Start();
            }
        }
        else
        {
            MessageBox.Show(
                &quot;Automatic mode is required to start execution from a remote client.&quot;);
        }
    }
    catch (System.InvalidOperationException ex)
    {
        MessageBox.Show(&quot;Mastership is held by another client.&quot; + ex.Message);
    }
    catch (System.Exception ex)
    {
        MessageBox.Show(&quot;Unexpected error occurred: &quot; + ex.Message);
    }
}
</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Copyright © 2024 ABB</span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
